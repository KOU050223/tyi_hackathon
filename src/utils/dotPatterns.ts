import type { Expression, DotPattern, ExpressionPatterns } from '@/types/expression'

/**
 * 各表情に対応するドット絵パターン定義
 * 0 = 透明, 1 = 塗りつぶし
 */

// 目のみのパターン（スマートフォン用）
const eyeOnlyPatterns: ExpressionPatterns = {
  neutral: {
    color: '#00FF00',
    grid: [
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
    ],
  },
  smile: {
    color: '#FFFF00',
    grid: [
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
    ],
  },
  surprised: {
    color: '#FF6600',
    grid: [
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
    ],
  },
  blink: {
    color: '#00FF00',
    grid: [
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
    ],
  },
}

// 目 + 口のパターン（タブレット用）
const fullPatterns: ExpressionPatterns = {
  neutral: {
    color: '#00FF00',
    grid: [
      // 目
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      // 口
      [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ],
  },
  smile: {
    color: '#FFFF00',
    grid: [
      // 目
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      // 口（笑顔）
      [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
      [0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
    ],
  },
  surprised: {
    color: '#FF6600',
    grid: [
      // 目（大きく開いた）
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1],
      [0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0],
      [0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      // 口（驚き）
      [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0],
      [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0],
      [0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0],
    ],
  },
}

/**
 * デバイスタイプに応じた表情パターンを取得
 */
export const getDotPattern = (
  expression: Expression,
  deviceType: 'smartphone' | 'tablet'
): DotPattern => {
  const patterns = deviceType === 'smartphone' ? eyeOnlyPatterns : fullPatterns
  return patterns[expression] || patterns.neutral
}

/**
 * 目のみのパターンを取得（スマートフォン用）
 */
export const getEyeOnlyPattern = (expression: Expression): DotPattern => {
  return eyeOnlyPatterns[expression] || eyeOnlyPatterns.neutral
}

/**
 * 目 + 口のパターンを取得（タブレット用）
 */
export const getFullPattern = (expression: Expression): DotPattern => {
  return fullPatterns[expression] || fullPatterns.neutral
}
